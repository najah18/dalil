!function(e){"use strict";var i;redux.field_objects=redux.field_objects||{},redux.field_objects.wpestate_property_card_details_customizer=redux.field_objects.wpestate_property_card_details_customizer||{},e(document).ready(function(){}),redux.field_objects.wpestate_property_card_details_customizer.init=function(t){t||(t=e(document).find(".redux-group-tab:visible").find(".redux-container-media-card-details:visible")),e(t).each(function(){var t=e(this),d=t;t.hasClass("redux-field-container")||(d=t.parents(".redux-field-container:first")),!d.is(":hidden")&&(d.hasClass("redux-field-init")&&d.removeClass("redux-field-init"),i=!1,t.find(".remove-image, .remove-file").unbind("click").on("click",function(){redux.field_objects.wpestate_property_card_details_customizer.removeFile(e(this).parents("fieldset.redux-field:first"))}),t.find(".media_upload_button").unbind().on("click",function(i){var t=jQuery(this).attr("data-attr-button-no");redux.field_objects.wpestate_property_card_details_customizer.addFile(i,e(this).parents("fieldset.redux-field:first"),t)}))})},redux.field_objects.wpestate_property_card_details_customizer.addFile=function(t,d,a){t.preventDefault();var r,s,o=e(this);if(r){r.open();return}var l=e(d).find(".library-filter").data("lib-filter");void 0!==l&&""!==l&&(s=[],i=!0,l=JSON.parse(l=decodeURIComponent(l)),e.each(l,function(e,i){s.push(i)})),(r=wp.media({multiple:!1,library:{type:s},title:o.data("choose"),button:{text:o.data("update")}})).on("select",function(){var t=r.state().get("selection").first();r.close();var s=e(d).find(".data").data();if((void 0===redux.field_objects.media||(redux.field_objects.media,0))&&(redux.field_objects.media={}),(void 0===s||"undefined"===s.mode)&&((s={}).mode="image"),!0===i&&(s.mode=0),0===s.mode);else if(!1!==s.mode&&t.attributes.type!==s.mode&&t.attributes.subtype!==s.mode)return;d.find("#url_field_"+a).val(t.attributes.url),d.find("#preview_field_"+a).attr("src",t.attributes.url),d.find(".upload-id").val(t.attributes.id),d.find(".upload-height").val(t.attributes.height),d.find(".upload-width").val(t.attributes.width),redux_change(e(d).find(".upload-id"));var o=t.attributes.url;if(void 0!==t.attributes.sizes&&void 0!==t.attributes.sizes.thumbnail)o=t.attributes.sizes.thumbnail.url;else if(void 0!==t.attributes.sizes){var l=t.attributes.height;for(var n in t.attributes.sizes){var u=t.attributes.sizes[n];u.height<l&&(l=u.height,o=u.url)}}else o=t.attributes.icon;d.find(".upload-thumbnail").val(o),d.find(".upload").hasClass("noPreview")||d.find(".screenshot").empty().hide().append('<img class="redux-option-image" src="'+o+'">').slideDown("fast"),d.find(".remove-image").removeClass("hide"),d.find(".redux-background-properties").slideDown()}),r.open()},redux.field_objects.wpestate_property_card_details_customizer.removeFile=function(i){i.find(".remove-image").addClass("hide")&&(i.find(".remove-image").addClass("hide"),i.find(".upload").val(""),i.find(".upload-id").val(""),i.find(".upload-height").val(""),i.find(".upload-width").val(""),i.find(".upload-thumbnail").val(""),redux_change(e(i).find(".upload-id")),i.find(".redux-background-properties").hide(),i.find(".screenshot").slideUp(),i.find(".remove-file").unbind(),i.find(".section-upload .upload-notice").length>0&&i.find(".media_upload_button").remove())}}(jQuery);