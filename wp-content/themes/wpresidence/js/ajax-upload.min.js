function wpestate_thumb_setter(){"use strict";jQuery("#imagelist img").dblclick(function(){jQuery("#imagelist .uploaded_images .thumber").each(function(){jQuery(this).remove()}),jQuery(this).parent().append('<i class="fa thumber fa-star"></i>'),jQuery("#attachthumb").val(jQuery(this).parent().attr("data-imageid"))})}function wpestate_delete_binder(){"use strict";jQuery("#imagelist i.fa-trash-alt").unbind("click"),jQuery("#imagelist i.fa-trash-alt").on("click",function(a){var e="",t="",i=jQuery(this).parent().attr("data-imageid"),r=jQuery("#wpestate_image_upload").val();current_no_up-=1,jQuery(this).parent().remove(),jQuery("#imagelist .uploaded_images").each(function(){t=jQuery(this).attr("data-imageid"),e=e+","+t}),jQuery("#attachid").val(e),jQuery.ajax({type:"POST",url:ajaxurl,data:{action:"wpestate_delete_file",attach_id:i,security:r},success:function(a){},error:function(a){}})})}function wpestate_caption_setter(){"use strict";jQuery(".image_caption_button").unbind("click"),jQuery(".image_caption_button").on("click",function(a){jQuery(this).toggleClass("active_caption"),jQuery(this).parent().find(".image_caption_wrapper").toggle()}),jQuery(".image_caption").unbind("change"),jQuery(".image_caption").on("change",function(){var a=jQuery(this).attr("data-imageid"),e=jQuery(this).val(),t=jQuery("#wpestate_image_upload").val();jQuery.ajax({type:"POST",url:ajaxurl,data:{action:"wpestate_image_caption",attach_id:a,caption:e,security:t},success:function(a){},error:function(a){}})})}var current_no_up;jQuery(document).ready(function(a){"use strict";var e;wpestate_delete_binder(),wpestate_caption_setter();var t=0;if(current_no_up=parseInt(a(".uploaded_images ").length,10),e=0,"undefined"!=typeof plupload){var i=new plupload.Uploader(ajax_vars.plupload);i.init(),i.bind("FilesAdded",function(r,n){if(ajax_vars.max_images>0){if(0===current_no_up?(e=ajax_vars.max_images,current_no_up=n.length>ajax_vars.max_images?e:n.length):current_no_up>=ajax_vars.max_images?e=-1:(e=ajax_vars.max_images-current_no_up,n.length>e?current_no_up+=e:current_no_up+=n.length),e>0){r.files.slice(0,e),n.slice(0,e);for(;n.length>e;)r.files.pop(),n.pop(),t=1}if(1===t&&(a(".image_max_warn").remove(),a("#imagelist").before('<div class="image_max_warn" style="width:100%;float:left;">'+ajax_vars.warning_max+"</div>")),-1==e)return a(".image_max_warn").remove(),a("#imagelist").before('<div class="image_max_warn" style="width:100%;float:left;">'+ajax_vars.warning_max+"</div>"),n=[],void(r=[])}a.each(n,function(e,t){a("#aaiu-upload-imagelist").append('<div id="'+t.id+'">'+t.name+" ("+plupload.formatSize(t.size)+") <b></b></div>")}),r.refresh(),i.start()}),i.bind("UploadProgress",function(e,t){a("#"+t.id+" b").html(t.percent+"%")}),i.bind("Error",function(e,t){a("#aaiu-upload-imagelist").append("<div>Error: "+t.code+", Message: "+t.message+(t.file?", File: "+t.file.name:"")+"</div>"),e.refresh()}),i.bind("FileUploaded",function(e,t,i){var r=a.parseJSON(i.response);if(a("#image_warn").remove(),a("#"+t.id).remove(),r.success){a("#profile-image").attr("src",r.html),a("#profile-image").attr("data-profileurl",r.html),a("#profile-image").attr("data-smallprofileurl",r.attach);var n=a("#attachid").val();n=n+","+r.attach,a("#attachid").val(n),""!==r.html?"1"===ajax_vars.is_floor?(a("#no_plan_mess").remove(),a("#imagelist").append('<div class="uploaded_images floor_container" data-imageid="'+r.attach+'"><input type="hidden" name="plan_image_attach[]" value="'+r.attach+'"><input type="hidden" name="plan_image[]" value="'+r.html+'"><img src="'+r.html+'"  /><i class="deleter  far fa-trash-alt"></i>'+to_insert_floor+"</div>")):a("#imagelist").append('<div class="uploaded_images" data-imageid="'+r.attach+'"><img src="'+r.html+'"  /><i class="deleter far fa-trash-alt"></i><i class="fas fa-font image_caption_button"></i><div class="image_caption_wrapper"><input data-imageid="'+r.attach+'" type="text" class="image_caption form_control" name="image_caption" value=""></div>'):a("#imagelist").append('<div class="uploaded_images" data-imageid="'+r.attach+'"><img src="'+ajax_vars.path+'/img/pdf.png"  /><i class="deleter  far fa-trash-alt"></i> </div>'),jQuery().sortable&&a("#imagelist").sortable({revert:!0,update:function(e,t){var i,r;i="",a("#imagelist .uploaded_images").each(function(){r=a(this).attr("data-imageid"),void 0!==r&&(i=i+","+r)}),a("#attachid").val(i)}}),wpestate_delete_binder(),wpestate_caption_setter(),wpestate_thumb_setter()}else r.image&&(a("#imagelist").before('<div id="image_warn" style="width:100%;float:left;">'+ajax_vars.warning+"</div>"),a("#imagelist-profile").before('<div id="image_warn">'+ajax_vars.warning+"</div>"),current_no_up-=1)}),jQuery("#aaiu-uploader").on("click",function(a){a.preventDefault(),i.splice(),i.refresh()}),a("#aaiu-uploader2").on("click",function(a){i.start(),a.preventDefault()}),jQuery("aaiu-uploader-floor-plans").on("click",function(a){a.preventDefault(),i.splice(),i.refresh()}),a("#aaiu-uploader-floor").on("click",function(e){e.preventDefault(),a("#aaiu-uploader").trigger("click")}),i.splice(),i.refresh()}i.splice(),i.refresh()}),to_insert_floor='<div class=""><p class="meta-options floor_p">\n                <label for="plan_title">'+control_vars.plan_title+'</label><br />\n                <input id="plan_title" type="text" size="36" name="plan_title[]" value="" />\n            </p>\n            \n            <p class="meta-options floor_full"> \n                <label for="plan_description">'+control_vars.plan_desc+'</label><br /> \n                <textarea class="plan_description" type="text" size="36" name="plan_description[]" ></textarea> \n            </p>\n             \n            <p class="meta-options floor_p"> \n                <label for="plan_size">'+control_vars.plan_size+'</label><br /> \n                <input id="plan_size" type="text" size="36" name="plan_size[]" value="" /> \n            </p> \n            \n            <p class="meta-options floor_p"> \n                <label for="plan_rooms">'+control_vars.plan_rooms+'</label><br /> \n                <input id="plan_rooms" type="text" size="36" name="plan_rooms[]" value="" /> \n            </p> \n            <p class="meta-options floor_p"> \n                <label for="plan_bath">'+control_vars.plan_bathrooms+'</label><br /> \n                <input id="plan_bath" type="text" size="36" name="plan_bath[]" value="" /> \n            </p> \n            <p class="meta-options floor_p"> \n                <label for="plan_price">'+control_vars.plan_price+'</label><br /> \n                <input id="plan_price" type="text" size="36" name="plan_price[]" value="" /> \n            </p> \n    </div>';